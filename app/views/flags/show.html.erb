<% if !have_recent_location? %>
  <script>
  $(document).on('turbolinks:load', function() {
    getGeoLocation();
  });
  </script>
<% end %>

<h3>
  <%= @flag.name %>
</h3>

<p>
  <strong>Host:</strong>
  <%= link_to @flag.user.name, user_path(@flag.user) %>
</p>

<p>
  <%= @flag.description %>
  <div><%= @flag.address %></div>
  <div>
    <% if !user_checked_in?(@flag) && user_near_flag?(@flag)%>
      <%= link_to "Check in", checkins_path(@flag), method: "post" %>
    <% elsif user_checked_in?(@flag)%>
      Checked in!
    <% end %>
  </div>
</p>
<% if user_checked_in?(@flag) %>
  <%= render "search_tracks", flag: @flag %>
   <!-- to be used with react magic later
   <#%= react_component("TracksApp", props: @tracks_props, prerender: false) %>
    -->
<% end %>


<div>
  Tracks:
  <% @flag.tracks.each do |track| explode %>
    <%= render :partial => "shared/track", locals: {track: track} %>
  <% end %>
</div>
<%= link_to "Tracks API", api_tracks_path %>

<%= link_to 'Edit', edit_flag_path(@flag) %> |
<%= link_to 'Back', flags_path %>
